////////////////why we need trigger/////////////////
  1,è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚æ²¡æœ‰ä¸è§¦å‘å™¨å…³è”çš„é™åˆ¶ï¼Œå¼€å‘äººå‘˜çš„æŠ€èƒ½ï¼Œæƒ³è±¡åŠ›ï¼Œå’Œsalesforceç®¡ç†å™¨é™åˆ¶æ˜¯è¿™é‡Œå”¯ä¸€çš„é™åˆ¶ï¼Œå¯ä»¥è½»æ¾çš„ç»•è¿‡è¿™äº›é™åˆ¶ã€‚
  2.å¯ä»¥å®æ–½å¤æ‚çš„éªŒè¯è§„åˆ™ï¼Œå°½ç®¡salesforceå…è®¸æ‚¨é€šè¿‡ç®€å•çš„ç‚¹å‡»å·¥å…·åˆ›å»ºè‡ªå®šä¹‰éªŒè¯è§„åˆ™ã€‚ä½†ä¸€äº›å¤æ‚çš„éªŒè¯è§„åˆ™ï¼Œæ‚¨æ— æ³•é€šè¿‡ç®€å•çš„æŒ‡å‘å’Œå•å‡»æ¥åˆ›å»º
  3ï¼Œå½“salesforceä¸­çš„æ•°æ®å‘ç”Ÿæ›´æ”¹æ—¶ï¼Œtriggerå¯ä»¥ç”¨äºä¸ç¬¬ä¸‰æ–¹ç³»ç»Ÿè¿›è¡Œé€šä¿¡ã€‚
  4ï¼Œtriggerå¾ˆå¿«ï¼Œæ¯”work flowæ›´å¿«ï¼Œæ¯”æµç¨‹æ„å»ºå™¨æ›´å¿«ï¼Œæ¯”å¯è§†åŒ–æµç¨‹å¿«å¾—å¤š
  5ï¼ŒApex triggeræ”¯æŒsalesforceå¯¹è±¡ä¸­æ‰€æœ‰ç±»å‹çš„æ•°æ®æ›´æ”¹ã€‚


////////////////trigger Event/////////////////

befor insert
after insert

befor uptate
after update

befor delete
after delete

after yndelete


////////////////trigger éªŒè¯ å¹¶ä¸”æŠ›å‡ºé”™è¯¯/////////////////

addError()


////////////////ç¦ç”¨ æˆ–åœç”¨ trigger/////////////////

ä»è®¾ç½®èœå•ç¦ç”¨æˆ–åœç”¨ trigger



////////////////trigger æ‰§è¡Œé¡ºåº/////////////////
Apexå…è®¸åœ¨åŒä¸€Sobjectä¸Šåˆ›å»ºå¤šä¸ªè§¦å‘å™¨ï¼Œä½†æœ‰å¤šä¸ªtriggeræ—¶ï¼Œæ— æ³•ä¿è¯Triggerçš„æ‰§è¡Œé¡ºåº
æœ€å¥½åŒä¸€ä¸ªSobjectä¸Šåªæœ‰ä¸€ä¸ªè§¦å‘å™¨


////////////////trigger ç±»/////////////////

Trigger.[variable name]
  Trigger.isInsert
  Trigger.isDelete
  
isInsert	æŒ¿å…¥æ“ä½œã«ã‚ˆã‚Šã€Salesforce ãƒ¦ãƒ¼ã‚¶ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€Apexã€ã¾ãŸã¯ API ã‹ã‚‰ã“ã®ãƒˆãƒªã‚¬ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã«ã€true ã‚’è¿”ã—ã¾ã™ã€‚
isUpdate	æ›´æ–°æ“ä½œã«ã‚ˆã‚Šã€Salesforce ãƒ¦ãƒ¼ã‚¶ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€Apexã€ã¾ãŸã¯ API ã‹ã‚‰ã“ã®ãƒˆãƒªã‚¬ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã«ã€true ã‚’è¿”ã—ã¾ã™ã€‚
isDelete	å‰Šé™¤æ“ä½œã«ã‚ˆã‚Šã€Salesforce ãƒ¦ãƒ¼ã‚¶ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€Apexã€ã¾ãŸã¯ API ã‹ã‚‰ã“ã®ãƒˆãƒªã‚¬ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã«ã€true ã‚’è¿”ã—ã¾ã™ã€‚
isBefore	ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒä¿å­˜ã•ã‚Œã‚‹å‰ã«ã“ã®ãƒˆãƒªã‚¬ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã«ã€true ã‚’è¿”ã—ã¾ã™ã€‚
isAfter	ã™ã¹ã¦ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒä¿å­˜ã•ã‚ŒãŸå¾Œã«ã“ã®ãƒˆãƒªã‚¬ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã«ã€true ã‚’è¿”ã—ã¾ã™ã€‚
isUndelete	ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã”ã¿ç®±ã‹ã‚‰å¾©å…ƒã•ã‚ŒãŸå¾Œã«ã“ã®ãƒˆãƒªã‚¬ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã«ã€true ã‚’è¿”ã—ã¾ã™ã€‚ã“ã®å¾©å…ƒã¯ã€Salesforce ãƒ¦ãƒ¼ã‚¶ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€Apexã€ã¾ãŸã¯ API ã‹ã‚‰ã®å¾©å…ƒæ“ä½œã®å¾Œã«ã®ã¿è¡Œã‚ã‚Œã¾ã™ã€‚
...

https://developer.salesforce.com/docs/atlas.ja-jp.apexcode.meta/apexcode/apex_class_System_Trigger.htm

----------------------ç¤ºä¾‹ä»£ç ---------------------------
trigger LeadTrigger on Lead (before insert, before update) {
	//System.debug('Lead trigger called');
    for(Lead leadRecord : Trigger.new){
        if(String.isBlank(leadRecord.LeadSource)){
            leadRecord.LeadSource = 'Other';
        }
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
        // check only in update operation
        if(String.isBlank(leadRecord.Industry) && Trigger.isInsert){
            leadRecord.addError('The industry field cannot be blank');
        }
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
    }
    System.debug('Lead trigger 1 is executing');
}

----------------------ç¤ºä¾‹ä»£ç ---------------------------



////////////////trigger ä¸Šä¸‹æ–‡å˜é‡/////////////////

new	æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® sObject ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã® sObject ãƒªã‚¹ãƒˆã¯ insert ãƒˆãƒªã‚¬ã€update ãƒˆãƒªã‚¬ã€ãŠã‚ˆã³ undelete ãƒˆãƒªã‚¬ã§ã®ã¿ä½¿ç”¨ã§ãã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯ before ãƒˆãƒªã‚¬ã§ã®ã¿å¤‰æ›´ã§ãã¾ã™ã€‚

newMap	æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® sObject ãƒ¬ã‚³ãƒ¼ãƒ‰ã¸ã® ID ã®å¯¾å¿œä»˜ã‘ã§ã™ã€‚
        ã“ã®å¯¾å¿œä»˜ã‘ã¯ before update ãƒˆãƒªã‚¬ã€after insert ãƒˆãƒªã‚¬ã€after update ãƒˆãƒªã‚¬ã€ãŠã‚ˆã³ after undelete ãƒˆãƒªã‚¬ã§ã®ã¿ä½¿ç”¨ã§ãã¾ã™ã€‚

//new å’ŒnewMapçš„åŒºåˆ«ï¼šnewä¸Šä¸‹æ–‡å˜é‡æä¾›äº†ä¸€ä¸ªåˆ—è¡¨ï¼ŒnewMapæä¾›äº†ç‰¹å®šçš„IDå’Œç‰¹å®šSObjectçš„æ˜ å°„ã€‚


old	å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® sObject ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã® sObject ãƒªã‚¹ãƒˆã¯ update ãƒˆãƒªã‚¬ã¨ delete ãƒˆãƒªã‚¬ã§ã®ã¿ä½¿ç”¨ã§ãã¾ã™ã€‚

oldMap	å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® sObject ãƒ¬ã‚³ãƒ¼ãƒ‰ã¸ã® ID ã®å¯¾å¿œä»˜ã‘ã§ã™ã€‚
        ã“ã®å¯¾å¿œä»˜ã‘ã¯ update ãƒˆãƒªã‚¬ã¨ delete ãƒˆãƒªã‚¬ã§ã®ã¿ä½¿ç”¨ã§ãã¾ã™ã€‚

----------------------ç¤ºä¾‹ä»£ç ---------------------------

trigger LeadTrigger on Lead (before insert, before update, after update) {
    for(Lead leadRecord : Trigger.new){
        // if lead source is blank, then make it other
        if(Trigger.isBefore && String.isBlank(leadRecord.LeadSource)){
            leadRecord.LeadSource = 'Other';
        }
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
        // trigger validation using oldMap
        if((leadRecord.Status == 'Closed - Converted' || leadRecord.Status == 'Closed - Not Converted') 
            && Trigger.oldMap.get(leadRecord.Id).Status == 'Open - Not Contacted'){
              leadRecord.Status.addError('You cannot directly close an open lead record');
        }
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
        // validation rules on Industry fields
        if(String.isBlank(leadRecord.Industry) && Trigger.isInsert){
            leadRecord.addError('The industry field cannot be blank');
        }
    }
}
----------------------ç¤ºä¾‹ä»£ç ---------------------------

////////////////trigger ä¸Šä¸‹æ–‡å˜é‡2/////////////////

isExecuting	
      Apex ã‚³ãƒ¼ãƒ‰ã®ç¾åœ¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒ Visualforce ãƒšãƒ¼ã‚¸ã€Web ã‚µãƒ¼ãƒ“ã‚¹ã€ã¾ãŸã¯ executeanonymous() API ã‚³ãƒ¼ãƒ«ã§ã¯ãªãã€ãƒˆãƒªã‚¬ã§ã‚ã‚‹å ´åˆã€true ã‚’è¿”ã—ã¾ã™ã€‚
operationType	
      ç¾åœ¨ã®æ“ä½œã«å¯¾å¿œã™ã‚‹ System.TriggerOperation ç¨®åˆ¥ã®åˆ—æŒ™å€¤ã‚’è¿”ã—ã¾ã™ã€‚
      System.TriggerOperation åˆ—æŒ™ã®å¯èƒ½ãªå€¤ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚BEFORE_INSERTã€BEFORE_UPDATEã€BEFORE_DELETEã€AFTER_INSERTã€AFTER_UPDATEã€AFTER_DELETEã€AFTER_UNDELETEã€‚ãƒˆãƒªã‚¬ã®ç¨®é¡ã«åŸºã¥ã„ã¦ã€ç•°ãªã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€switch ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ä¸€æ„ã®ãƒˆãƒªã‚¬å®Ÿè¡Œåˆ—æŒ™çŠ¶æ…‹ã®ç•°ãªã‚‹é †åˆ—ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚’æ¤œè¨ã—ã¾ã™ã€‚
size	
    å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¸¡æ–¹ã‚’å«ã‚€ã€ãƒˆãƒªã‚¬å‘¼ã³å‡ºã—ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®åˆè¨ˆæ•°ã€‚

----------------------ç¤ºä¾‹ä»£ç ---------------------------
trigger LeadTrigger on Lead (before insert, before update, after update) {
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
    System.debug('Trigger size: '+ Trigger.size);
    System.debug('is trigger: '+ Trigger.isExecuting);
    System.debug('Operation type: '+ Trigger.operationType);
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
    for(Lead leadRecord : Trigger.new){
        // if lead source is blank, then make it other
        if(Trigger.isBefore && String.isBlank(leadRecord.LeadSource)){
            leadRecord.LeadSource = 'Other';
        }

        if((leadRecord.Status == 'Closed - Converted' || leadRecord.Status == 'Closed - Not Converted') && Trigger.oldMap.get(leadRecord.Id).Status == 'Open - Not Contacted'){
            leadRecord.Status.addError('You cannot directly close an open lead record');
        }
        // validation rules on Industry fields
        if(String.isBlank(leadRecord.Industry) && Trigger.isInsert){
            leadRecord.addError('The industry field cannot be blank');
        }
    }
}
----------------------ç¤ºä¾‹ä»£ç ---------------------------

----------------------åŒ¿åå—æ‰§è¡Œ---------------------------
// insert single lead
Lead newLead = new Lead(LastName='Test Lead Single', Status='Open - Not Contacted', Company='SFDCFacts', Industry='Finance');
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
System.debug('Trigger size: '+ Trigger.size);
System.debug('is trigger: '+ Trigger.isExecuting);
System.debug('Operation type: '+ Trigger.operationType);
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
insert newLead;

// Insert multiple leads
List<Lead> multipleLeads = new List<Lead>();
for(Integer i=0; i<10; i++){
    multipleLeads.add(new Lead(LastName='Test Lead Single', Status='Open - Not Contacted', Company='SFDCFacts', Industry='Finance'));
}
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
System.debug('Trigger size: '+ Trigger.size);
System.debug('is trigger: '+ Trigger.isExecuting);
System.debug('Operation type: '+ Trigger.operationType);
ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
insert multipleLeads;

----------------------åŒ¿åå—æ‰§è¡Œ---------------------------




